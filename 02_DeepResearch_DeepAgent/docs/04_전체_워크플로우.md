# ì „ì²´ ì›Œí¬í”Œë¡œìš° ìƒì„¸ ê°€ì´ë“œ

## ğŸ“Œ ì›Œí¬í”Œë¡œìš°ë€?

**ì›Œí¬í”Œë¡œìš°(Workflow)**ëŠ” ì‹œìŠ¤í…œì´ ì‚¬ìš©ì ì§ˆë¬¸ì„ ë°›ì•„ ìµœì¢… ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ê¸°ê¹Œì§€ì˜ ì „ì²´ ê³¼ì •ì…ë‹ˆë‹¤. ë§ˆì¹˜ ìš”ë¦¬ ë ˆì‹œí”¼ì²˜ëŸ¼, ê° ë‹¨ê³„ê°€ ìˆœì„œëŒ€ë¡œ ì§„í–‰ë©ë‹ˆë‹¤.

---

## ğŸ¬ ì „ì²´ íë¦„ í•œëˆˆì— ë³´ê¸°

```
ì‚¬ìš©ì ì§ˆë¬¸
    â†“
[STAGE 1] ëª…í™•í™” ë‹¨ê³„
    â†“
[STAGE 2] ì—°êµ¬ ê³„íš ìˆ˜ë¦½
    â†“
[STAGE 3] ë³‘ë ¬ ì—°êµ¬ ìˆ˜í–‰
    â†“
[STAGE 4] ì •ë³´ ì••ì¶•
    â†“
[STAGE 5] í’ˆì§ˆ ê²€ì¦ (ì„ íƒ)
    â†“
[STAGE 6] ìµœì¢… ë³´ê³ ì„œ ìƒì„±
    â†“
ì‚¬ìš©ìì—ê²Œ ì „ë‹¬
```

---

## ğŸ” STAGE 1: ëª…í™•í™” ë‹¨ê³„

### ëª©ì 
ì‚¬ìš©ìì˜ ì§ˆë¬¸ì´ ëª¨í˜¸í•œ ê²½ìš° ì¶”ê°€ ì •ë³´ë¥¼ ìš”ì²­í•©ë‹ˆë‹¤.

### ë™ì‘ ê³¼ì •

```python
# ì…ë ¥
user_question = "AIì— ëŒ€í•´ ì•Œë ¤ì¤˜"

# ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° ë¶„ì„
"""
ì§ˆë¬¸ì´ ë„ˆë¬´ ê´‘ë²”ìœ„í•©ë‹ˆë‹¤.
- AIì˜ ì–´ë–¤ ì¸¡ë©´? (ê¸°ìˆ , ìœ¤ë¦¬, ì‘ìš© ë¶„ì•¼?)
- ì–´ë–¤ ìˆ˜ì¤€? (ì…ë¬¸, ì¤‘ê¸‰, ì „ë¬¸ê°€?)
- ì–´ë–¤ ëª©ì ? (í•™ìŠµ, ì—°êµ¬, ë¹„ì¦ˆë‹ˆìŠ¤?)
"""

# ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸
clarification = ClarifyWithUser(
    need_clarification=True,
    question="""
    AIì— ëŒ€í•œ ì—°êµ¬ ë²”ìœ„ë¥¼ êµ¬ì²´í™”í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤:
    1. ì–´ë–¤ ì¸¡ë©´ì— ê´€ì‹¬ì´ ìˆìœ¼ì‹ ê°€ìš”? (ì˜ˆ: ê¸°ìˆ , ìœ¤ë¦¬, ì‘ìš©)
    2. ì–´ë–¤ ìˆ˜ì¤€ì˜ ì •ë³´ê°€ í•„ìš”í•œê°€ìš”? (ì˜ˆ: ê°œìš”, ì‹¬ì¸µ ë¶„ì„)
    3. íŠ¹ì • ì‚°ì—…ì´ë‚˜ ë¶„ì•¼ê°€ ìˆë‚˜ìš”?
    """,
    verification="ë‹µë³€ ì£¼ì‹œë©´ ë§ì¶¤í˜• ì—°êµ¬ë¥¼ ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤."
)

# ì‚¬ìš©ì ì‘ë‹µ
user_response = "AI ìœ¤ë¦¬ì— ëŒ€í•œ ì‹¬ì¸µ ë¶„ì„ì´ í•„ìš”í•´ìš”"

# ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰
proceed_to_stage_2()
```

### ëª…í™•í™”ê°€ í•„ìš”í•œ ê²½ìš°

| ì§ˆë¬¸ ìœ í˜• | ì˜ˆì‹œ | ëª…í™•í™” í•„ìš” ì—¬ë¶€ |
|----------|------|----------------|
| ë„ˆë¬´ ê´‘ë²”ìœ„ | "AIì— ëŒ€í•´ ì•Œë ¤ì¤˜" | âœ… í•„ìš” |
| êµ¬ì²´ì  | "GPT-4ì˜ ì•„í‚¤í…ì²˜ ì„¤ëª…í•´ì¤˜" | âŒ ë¶ˆí•„ìš” |
| ëª¨í˜¸í•œ ìš©ì–´ | "ê·¸ê²ƒì— ëŒ€í•´ ì¡°ì‚¬í•´ì¤˜" | âœ… í•„ìš” |
| ëª…í™•í•œ ë²”ìœ„ | "2024ë…„ AI ìœ¤ë¦¬ ê·œì œ ë™í–¥" | âŒ ë¶ˆí•„ìš” |

### ì½”ë“œ ì˜ˆì‹œ

```python
async def clarification_stage(state: AgentState):
    """STAGE 1: ì‚¬ìš©ì ì§ˆë¬¸ ëª…í™•í™”"""
    
    user_message = state["messages"][-1].content
    
    # LLMì—ê²Œ ëª…í™•í™” í•„ìš” ì—¬ë¶€ íŒë‹¨ ìš”ì²­
    response = await llm.ainvoke([
        SystemMessage(content="ì‚¬ìš©ì ì§ˆë¬¸ì´ ì¶©ë¶„íˆ êµ¬ì²´ì ì¸ì§€ íŒë‹¨í•˜ì„¸ìš”."),
        HumanMessage(content=user_message)
    ])
    
    # êµ¬ì¡°í™”ëœ ì¶œë ¥ íŒŒì‹±
    clarify = parse_clarification(response)
    
    if clarify.need_clarification:
        # ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸
        return {
            "messages": [AIMessage(content=clarify.question)],
            "current_stage": "awaiting_clarification"
        }
    else:
        # ë°”ë¡œ ë‹¤ìŒ ë‹¨ê³„ë¡œ
        return {
            "current_stage": "research_planning"
        }
```

---

## ğŸ“‹ STAGE 2: ì—°êµ¬ ê³„íš ìˆ˜ë¦½

### ëª©ì 
ì‚¬ìš©ì ì§ˆë¬¸ì„ ë¶„ì„í•˜ì—¬ êµ¬ì²´ì ì¸ ì—°êµ¬ ê³„íšì„ ìˆ˜ë¦½í•©ë‹ˆë‹¤.

### ë™ì‘ ê³¼ì •

```python
# ì…ë ¥
user_question = "AI ìœ¤ë¦¬ì— ëŒ€í•œ ì‹¬ì¸µ ë¶„ì„"

# ì—°êµ¬ ê³„íš ìƒì„±
research_brief = """
# ì—°êµ¬ ê³„íš: AI ìœ¤ë¦¬ ì‹¬ì¸µ ë¶„ì„

## ì—°êµ¬ ëª©í‘œ
AI ìœ¤ë¦¬ì˜ í•µì‹¬ ì›ì¹™, í˜„ì¬ ê³¼ì œ, í–¥í›„ ë°œì „ ë°©í–¥ì„ ì¢…í•©ì ìœ¼ë¡œ ë¶„ì„

## ì£¼ìš” ì—°êµ¬ ì§ˆë¬¸
1. AI ìœ¤ë¦¬ì˜ í•µì‹¬ ì›ì¹™ì€ ë¬´ì—‡ì¸ê°€?
   - íˆ¬ëª…ì„±, ê³µì •ì„±, ì±…ì„ì„± ë“±
   - ê° ì›ì¹™ì˜ ì •ì˜ì™€ ì¤‘ìš”ì„±

2. í˜„ì¬ ì§ë©´í•œ ìœ¤ë¦¬ì  ê³¼ì œëŠ”?
   - í¸í–¥ ë¬¸ì œ
   - í”„ë¼ì´ë²„ì‹œ ì¹¨í•´
   - ì¼ìë¦¬ ëŒ€ì²´

3. ê·œì œ ë° ì •ì±… ë™í–¥ì€?
   - EU AI Act
   - ë¯¸êµ­ AI ê¶Œë¦¬ì¥ì „
   - ê¸°ì—… ììœ¨ ê·œì œ

4. í–¥í›„ ë°œì „ ë°©í–¥ì€?
   - ê¸°ìˆ ì  í•´ê²°ì±…
   - ì •ì±…ì  ì ‘ê·¼
   - ì‚¬íšŒì  í•©ì˜

## ì˜ˆìƒ ê²°ê³¼ë¬¼
- ê° ì§ˆë¬¸ì— ëŒ€í•œ ì‹¬ì¸µ ë¶„ì„ (ìµœì†Œ 1,000ì)
- ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì¶œì²˜ ì¸ìš© (ìµœì†Œ 10ê°œ)
- êµ¬ì¡°í™”ëœ ë³´ê³ ì„œ í˜•ì‹

## ì—°êµ¬ ë°©ë²•
- ì›¹ ê²€ìƒ‰ì„ í†µí•œ ìµœì‹  ì •ë³´ ìˆ˜ì§‘
- í•™ìˆ  ë…¼ë¬¸ ë° ì •ì±… ë¬¸ì„œ ë¶„ì„
- ì „ë¬¸ê°€ ì˜ê²¬ ì¢…í•©
"""

# ìƒíƒœ ì—…ë°ì´íŠ¸
state["research_brief"] = research_brief
state["current_stage"] = "parallel_research"
```

### ì—°êµ¬ ê³„íšì˜ êµ¬ì„± ìš”ì†Œ

1. **ì—°êµ¬ ëª©í‘œ**: ë¬´ì—‡ì„ ë‹¬ì„±í•  ê²ƒì¸ê°€?
2. **ì£¼ìš” ì§ˆë¬¸**: ì–´ë–¤ ì§ˆë¬¸ì— ë‹µí•  ê²ƒì¸ê°€?
3. **ì˜ˆìƒ ê²°ê³¼**: ì–´ë–¤ í˜•íƒœì˜ ê²°ê³¼ë¬¼?
4. **ì—°êµ¬ ë°©ë²•**: ì–´ë–»ê²Œ ì¡°ì‚¬í•  ê²ƒì¸ê°€?

---

## ğŸ”¬ STAGE 3: ë³‘ë ¬ ì—°êµ¬ ìˆ˜í–‰

### ëª©ì 
ì—¬ëŸ¬ ì—°êµ¬ì ì—ì´ì „íŠ¸ê°€ ë™ì‹œì— ë‹¤ë¥¸ ì£¼ì œë¥¼ ì¡°ì‚¬í•©ë‹ˆë‹¤.

### ë™ì‘ ê³¼ì •

```python
# ì—°êµ¬ ê³„íšì—ì„œ í•˜ìœ„ ì£¼ì œ ì¶”ì¶œ
sub_topics = [
    "AI ìœ¤ë¦¬ì˜ í•µì‹¬ ì›ì¹™",
    "í˜„ì¬ ì§ë©´í•œ ìœ¤ë¦¬ì  ê³¼ì œ",
    "ê·œì œ ë° ì •ì±… ë™í–¥",
    "í–¥í›„ ë°œì „ ë°©í–¥"
]

# ë³‘ë ¬ ì—°êµ¬ ì‹œì‘
researchers = []
for topic in sub_topics:
    researcher = spawn_researcher(
        research_topic=topic,
        tools=[tavily_search, think_tool]
    )
    researchers.append(researcher)

# ëª¨ë“  ì—°êµ¬ì ë™ì‹œ ì‹¤í–‰
results = await asyncio.gather(*[
    r.research() for r in researchers
])

# ê²°ê³¼ ìˆ˜ì§‘
for result in results:
    state["raw_notes"].append(result.compressed_research)
    
state["research_iterations"] += 1
```

### ê°œë³„ ì—°êµ¬ìì˜ ì‘ì—…

#### Researcher 1: "AI ìœ¤ë¦¬ì˜ í•µì‹¬ ì›ì¹™"
```python
# 1. ì›¹ ê²€ìƒ‰
search_results = tavily_search("AI ethics core principles")

# 2. ì •ë³´ ì •ë¦¬
note = """
## AI ìœ¤ë¦¬ì˜ í•µì‹¬ ì›ì¹™

### 1. íˆ¬ëª…ì„± (Transparency)
- ì •ì˜: AI ì‹œìŠ¤í…œì˜ ê²°ì • ê³¼ì •ì„ ì´í•´í•˜ê³  ì„¤ëª…í•  ìˆ˜ ìˆì–´ì•¼ í•¨
- ì¤‘ìš”ì„±: ì‚¬ìš©ì ì‹ ë¢° í™•ë³´, ì±…ì„ ì†Œì¬ ëª…í™•í™”
- êµ¬í˜„ ë°©ë²•: ì„¤ëª… ê°€ëŠ¥í•œ AI (XAI), ì•Œê³ ë¦¬ì¦˜ ê³µê°œ
(ì¶œì²˜: IEEE Ethically Aligned Design, 2024)

### 2. ê³µì •ì„± (Fairness)
- ì •ì˜: ëª¨ë“  ì‚¬ìš©ìì—ê²Œ í¸í–¥ ì—†ì´ ê³µí‰í•œ ê²°ê³¼ ì œê³µ
- ì¤‘ìš”ì„±: ì°¨ë³„ ë°©ì§€, ì‚¬íšŒì  í‰ë“± ì¦ì§„
- êµ¬í˜„ ë°©ë²•: ê³µì •ì„± ë©”íŠ¸ë¦­, ë‹¤ì–‘í•œ ë°ì´í„°ì…‹
(ì¶œì²˜: ACM FAccT Conference, 2024)

### 3. ì±…ì„ì„± (Accountability)
- ì •ì˜: AI ì‹œìŠ¤í…œì˜ í–‰ë™ì— ëŒ€í•œ ì±…ì„ ì†Œì¬ ëª…í™•í™”
- ì¤‘ìš”ì„±: í”¼í•´ ë°œìƒ ì‹œ êµ¬ì œ ê°€ëŠ¥
- êµ¬í˜„ ë°©ë²•: ê°ì‚¬ ì¶”ì , ì±…ì„ í”„ë ˆì„ì›Œí¬
(ì¶œì²˜: Partnership on AI, 2024)
"""

# 3. íŒŒì¼ ì €ì¥
write_file("/output/notes/core_principles.md", note)

# 4. ì™„ë£Œ ì‹ í˜¸
return ResearchComplete()
```

#### Researcher 2: "í˜„ì¬ ì§ë©´í•œ ìœ¤ë¦¬ì  ê³¼ì œ"
```python
# ìœ ì‚¬í•œ í”„ë¡œì„¸ìŠ¤ë¡œ ë‹¤ë¥¸ ì£¼ì œ ì¡°ì‚¬
search_results = tavily_search("AI ethics challenges 2024")
# ... ì •ë³´ ì •ë¦¬ ë° ì €ì¥
```

### ë³‘ë ¬ ì²˜ë¦¬ì˜ ì¥ì 

```
ìˆœì°¨ ì²˜ë¦¬ (ëŠë¦¼):
Researcher 1 (5ë¶„) â†’ Researcher 2 (5ë¶„) â†’ Researcher 3 (5ë¶„) â†’ Researcher 4 (5ë¶„)
ì´ ì†Œìš” ì‹œê°„: 20ë¶„

ë³‘ë ¬ ì²˜ë¦¬ (ë¹ ë¦„):
Researcher 1 (5ë¶„) â”
Researcher 2 (5ë¶„) â”œâ†’ ë™ì‹œ ì‹¤í–‰
Researcher 3 (5ë¶„) â”‚
Researcher 4 (5ë¶„) â”˜
ì´ ì†Œìš” ì‹œê°„: 5ë¶„
```

---

## ğŸ—œï¸ STAGE 4: ì •ë³´ ì••ì¶•

### ëª©ì 
ì—¬ëŸ¬ ì—°êµ¬ìê°€ ìˆ˜ì§‘í•œ ì •ë³´ë¥¼ í•˜ë‚˜ë¡œ í†µí•©í•˜ê³  ì •ë¦¬í•©ë‹ˆë‹¤.

### ë™ì‘ ê³¼ì •

```python
# 1. Compressor ì—ì´ì „íŠ¸ ì‹¤í–‰
compressor = invoke_compressor()

# 2. ëª¨ë“  ë…¸íŠ¸ íŒŒì¼ ì½ê¸°
notes_files = ls("/output/notes/")
# ['core_principles.md', 'challenges.md', 'regulations.md', 'future.md']

all_notes = []
for file in notes_files:
    content = read_file(f"/output/notes/{file}")
    all_notes.append(content)

# 3. ì •ë³´ ë¶„ì„
"""
- core_principles.md: íˆ¬ëª…ì„±, ê³µì •ì„±, ì±…ì„ì„± ì„¤ëª…
- challenges.md: í¸í–¥, í”„ë¼ì´ë²„ì‹œ, ì¼ìë¦¬ ë¬¸ì œ
- regulations.md: EU AI Act, ë¯¸êµ­ ì •ì±…
- future.md: ê¸°ìˆ ì /ì •ì±…ì  ë°œì „ ë°©í–¥

ì¤‘ë³µ ë°œê²¬:
- core_principles.mdì™€ challenges.md ëª¨ë‘ 'ê³µì •ì„±' ì–¸ê¸‰
- regulations.mdì™€ future.md ëª¨ë‘ 'EU AI Act' ì–¸ê¸‰
"""

# 4. ì¤‘ë³µ ì œê±° ë° ì¬êµ¬ì„±
compressed = """
# AI ìœ¤ë¦¬ ì¢…í•© ì—°êµ¬

## 1. í•µì‹¬ ì›ì¹™
### 1.1 íˆ¬ëª…ì„±
[core_principles.mdì—ì„œ ì¶”ì¶œ]

### 1.2 ê³µì •ì„±
[core_principles.mdì™€ challenges.md í†µí•©]
- ì›ì¹™ìœ¼ë¡œì„œì˜ ê³µì •ì„±
- ì‹¤ì œ ê³¼ì œ: í¸í–¥ ë¬¸ì œ

### 1.3 ì±…ì„ì„±
[core_principles.mdì—ì„œ ì¶”ì¶œ]

## 2. í˜„ì¬ ê³¼ì œ
### 2.1 í¸í–¥ ë¬¸ì œ
[challenges.mdì—ì„œ ì¶”ì¶œ, ê³µì •ì„±ê³¼ ì—°ê²°]

### 2.2 í”„ë¼ì´ë²„ì‹œ
[challenges.mdì—ì„œ ì¶”ì¶œ]

### 2.3 ì¼ìë¦¬ ëŒ€ì²´
[challenges.mdì—ì„œ ì¶”ì¶œ]

## 3. ê·œì œ ë™í–¥
### 3.1 EU AI Act
[regulations.mdì™€ future.md í†µí•©]
- í˜„ì¬ ìƒíƒœ
- í–¥í›„ ì „ë§

### 3.2 ë¯¸êµ­ ì •ì±…
[regulations.mdì—ì„œ ì¶”ì¶œ]

## 4. í–¥í›„ ë°œì „ ë°©í–¥
### 4.1 ê¸°ìˆ ì  ì ‘ê·¼
[future.mdì—ì„œ ì¶”ì¶œ]

### 4.2 ì •ì±…ì  ì ‘ê·¼
[future.mdì™€ regulations.md í†µí•©]

## ì°¸ê³  ë¬¸í—Œ
[ëª¨ë“  ì¶œì²˜ í†µí•© ì •ë¦¬]
"""

# 5. ì••ì¶•ëœ ê²°ê³¼ ì €ì¥
write_file("/output/compressed_research.md", compressed)

# 6. í†µê³„ ì—…ë°ì´íŠ¸
state["compressed_research_length"] = len(compressed)
state["raw_notes_length"] = sum(len(note) for note in all_notes)
```

### ì••ì¶• ì „í›„ ë¹„êµ

```
ì••ì¶• ì „ (4ê°œ íŒŒì¼):
â”œâ”€â”€ core_principles.md (3,500ì)
â”œâ”€â”€ challenges.md (4,200ì)
â”œâ”€â”€ regulations.md (3,800ì)
â””â”€â”€ future.md (3,000ì)
ì´ 14,500ì

ì••ì¶• í›„ (1ê°œ íŒŒì¼):
â””â”€â”€ compressed_research.md (5,200ì)

ì••ì¶•ë¥ : 64%
ì¤‘ë³µ ì œê±°: ì•½ 9,300ì
```

---

## âœ… STAGE 5: í’ˆì§ˆ ê²€ì¦ (ì„ íƒì )

### ëª©ì 
ìµœì¢… ë³´ê³ ì„œì˜ í’ˆì§ˆì„ ê²€ì¦í•˜ê³  ê°œì„ ì ì„ ì œì•ˆí•©ë‹ˆë‹¤.

### ë™ì‘ ê³¼ì •

```python
# 1. Critic ì—ì´ì „íŠ¸ ì‹¤í–‰ (enable_critique=Trueì¸ ê²½ìš°)
if config.enable_critique_phase:
    critic = invoke_critic()
    
    # 2. ë³´ê³ ì„œ ì½ê¸°
    research_brief = read_file("/research_brief.md")
    compressed_research = read_file("/output/compressed_research.md")
    
    # 3. í‰ê°€ ìˆ˜í–‰
    feedback = """
    # í’ˆì§ˆ ê²€ì¦ ê²°ê³¼
    
    ## ì™„ì „ì„±: 4/5
    âœ… ëª¨ë“  ì£¼ìš” ì§ˆë¬¸ì— ë‹µí•¨
    âŒ í–¥í›„ ë°œì „ ë°©í–¥ì´ ë‹¤ì†Œ ë¶€ì¡±
    
    ## ì •í™•ì„±: 5/5
    âœ… ëª¨ë“  ì •ë³´ ìµœì‹  (2024ë…„)
    âœ… ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì¶œì²˜
    
    ## êµ¬ì¡°: 4/5
    âœ… ë…¼ë¦¬ì  íë¦„
    âŒ ì¼ë¶€ ì„¹ì…˜ ê°„ ì—°ê²° ë¶€ì¡±
    
    ## ì¸ìš©: 3/5
    âœ… ì£¼ìš” ì¶œì²˜ ëª…ì‹œ
    âŒ ì¼ë¶€ í†µê³„ì— ì¶œì²˜ ëˆ„ë½
    
    ## ê°œì„  ì œì•ˆ
    1. 4ì¥ì— êµ¬ì²´ì  ì‚¬ë¡€ ì¶”ê°€
    2. 2.1ì ˆì˜ í†µê³„ ë°ì´í„° ì¶œì²˜ ëª…ì‹œ
    3. ì„¹ì…˜ ê°„ ì „í™˜ ë¬¸ë‹¨ ì¶”ê°€
    """
    
    # 4. í”¼ë“œë°± ì €ì¥
    write_file("/feedback.md", feedback)
    
    # 5. ê°œì„  í•„ìš” ì—¬ë¶€ íŒë‹¨
    if needs_major_improvement(feedback):
        # ì¶”ê°€ ì—°êµ¬ ìˆ˜í–‰
        additional_research = spawn_researcher(
            research_topic="AI ìœ¤ë¦¬ í–¥í›„ ë°œì „ ë°©í–¥ êµ¬ì²´ì  ì‚¬ë¡€"
        )
        # ë‹¤ì‹œ ì••ì¶•
        invoke_compressor()
    else:
        # ìµœì¢… ë³´ê³ ì„œ ìƒì„±ìœ¼ë¡œ ì§„í–‰
        proceed_to_final_report()
```

### í’ˆì§ˆ ê¸°ì¤€

| ê¸°ì¤€ | í‰ê°€ í•­ëª© | í†µê³¼ ê¸°ì¤€ |
|------|----------|----------|
| ì™„ì „ì„± | ëª¨ë“  ì§ˆë¬¸ì— ë‹µí–ˆëŠ”ê°€? | 4/5 ì´ìƒ |
| ì •í™•ì„± | ì •ë³´ê°€ ì •í™•í•˜ê³  ìµœì‹ ì¸ê°€? | 4/5 ì´ìƒ |
| êµ¬ì¡° | ë…¼ë¦¬ì  íë¦„ì´ ìˆëŠ”ê°€? | 3/5 ì´ìƒ |
| ì¸ìš© | ì¶œì²˜ê°€ ëª…í™•í•œê°€? | 3/5 ì´ìƒ |
| ê¹Šì´ | ì¶©ë¶„íˆ ì‹¬ë„ ìˆëŠ”ê°€? | 3/5 ì´ìƒ |

---

## ğŸ“ STAGE 6: ìµœì¢… ë³´ê³ ì„œ ìƒì„±

### ëª©ì 
ì••ì¶•ëœ ì—°êµ¬ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìµœì¢… ë³´ê³ ì„œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

### ë™ì‘ ê³¼ì •

```python
# 1. ì••ì¶•ëœ ì—°êµ¬ ì½ê¸°
compressed_research = read_file("/output/compressed_research.md")

# 2. ì—°êµ¬ ê³„íš ì°¸ì¡°
research_brief = state["research_brief"]

# 3. ìµœì¢… ë³´ê³ ì„œ í”„ë¡¬í”„íŠ¸ ìƒì„±
final_report_prompt = f"""
ë‹¤ìŒ ì—°êµ¬ ê³„íšì— ë”°ë¼ ìµœì¢… ë³´ê³ ì„œë¥¼ ì‘ì„±í•˜ì„¸ìš”:

{research_brief}

ìˆ˜ì§‘ëœ ì—°êµ¬ ìë£Œ:
{compressed_research}

ìš”êµ¬ì‚¬í•­:
- ì „ë¬¸ì ì´ê³  ì½ê¸° ì‰¬ìš´ í˜•ì‹
- ëª…í™•í•œ êµ¬ì¡° (ì„œë¡ , ë³¸ë¡ , ê²°ë¡ )
- ëª¨ë“  ì£¼ì¥ì— ì¶œì²˜ ëª…ì‹œ
- í•µì‹¬ ë°œê²¬ì‚¬í•­ ê°•ì¡°
- ì‹¤ìš©ì  ì‹œì‚¬ì  ì œì‹œ

í˜„ì¬ ë‚ ì§œ: {date}
"""

# 4. LLMìœ¼ë¡œ ìµœì¢… ë³´ê³ ì„œ ìƒì„±
final_report = await llm.ainvoke([
    HumanMessage(content=final_report_prompt)
])

# 5. ë³´ê³ ì„œ ì €ì¥
write_file("/output/final_report.md", final_report.content)

# 6. ìƒíƒœ ì—…ë°ì´íŠ¸
state["final_report"] = final_report.content
state["current_stage"] = "complete"
```

### ìµœì¢… ë³´ê³ ì„œ êµ¬ì¡°

```markdown
# AI ìœ¤ë¦¬ ì‹¬ì¸µ ë¶„ì„ ë³´ê³ ì„œ

## ìš”ì•½ (Executive Summary)
- ì—°êµ¬ ëª©ì 
- ì£¼ìš” ë°œê²¬ì‚¬í•­
- í•µì‹¬ ì‹œì‚¬ì 

## 1. ì„œë¡ 
### 1.1 ë°°ê²½
### 1.2 ì—°êµ¬ ëª©ì 
### 1.3 ì—°êµ¬ ë°©ë²•

## 2. AI ìœ¤ë¦¬ì˜ í•µì‹¬ ì›ì¹™
### 2.1 íˆ¬ëª…ì„±
### 2.2 ê³µì •ì„±
### 2.3 ì±…ì„ì„±

## 3. í˜„ì¬ ì§ë©´í•œ ê³¼ì œ
### 3.1 í¸í–¥ ë¬¸ì œ
### 3.2 í”„ë¼ì´ë²„ì‹œ ì¹¨í•´
### 3.3 ì¼ìë¦¬ ëŒ€ì²´

## 4. ê·œì œ ë° ì •ì±… ë™í–¥
### 4.1 êµ­ì œ ë™í–¥
### 4.2 ì§€ì—­ë³„ ì •ì±…

## 5. í–¥í›„ ë°œì „ ë°©í–¥
### 5.1 ê¸°ìˆ ì  í•´ê²°ì±…
### 5.2 ì •ì±…ì  ì ‘ê·¼
### 5.3 ì‚¬íšŒì  í•©ì˜

## 6. ê²°ë¡ 
### 6.1 ì£¼ìš” ë°œê²¬ì‚¬í•­
### 6.2 ì‹œì‚¬ì 
### 6.3 ì œì–¸

## ì°¸ê³  ë¬¸í—Œ
[ëª¨ë“  ì¶œì²˜ ëª©ë¡]

## ë¶€ë¡
[ì¶”ê°€ ìë£Œ]
```

---

## ğŸ”„ ì „ì²´ ì›Œí¬í”Œë¡œìš° ì½”ë“œ

### ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜

```python
async def run_deep_research_workflow(
    user_question: str,
    config: DeepAgentConfiguration
) -> dict:
    """ì „ì²´ ì—°êµ¬ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰"""
    
    # ì´ˆê¸° ìƒíƒœ
    state = {
        "messages": [{"role": "user", "content": user_question}],
        "supervisor_messages": [],
        "research_brief": None,
        "raw_notes": [],
        "notes": [],
        "final_report": "",
        "research_iterations": 0,
        "current_stage": "clarification"
    }
    
    # STAGE 1: ëª…í™•í™”
    if config.enable_clarification:
        state = await clarification_stage(state)
        if state["current_stage"] == "awaiting_clarification":
            return state  # ì‚¬ìš©ì ì‘ë‹µ ëŒ€ê¸°
    
    # STAGE 2: ì—°êµ¬ ê³„íš
    state = await research_planning_stage(state)
    
    # STAGE 3: ë³‘ë ¬ ì—°êµ¬ (ìµœëŒ€ ë°˜ë³µ íšŸìˆ˜ê¹Œì§€)
    while state["research_iterations"] < config.max_researcher_iterations:
        state = await parallel_research_stage(state)
        
        # ì¶©ë¶„í•œ ì •ë³´ ìˆ˜ì§‘ ì—¬ë¶€ í™•ì¸
        if sufficient_information(state):
            break
    
    # STAGE 4: ì •ë³´ ì••ì¶•
    state = await compression_stage(state)
    
    # STAGE 5: í’ˆì§ˆ ê²€ì¦ (ì„ íƒì )
    if config.enable_critique_phase:
        state = await critique_stage(state)
        
        # ê°œì„  í•„ìš” ì‹œ ì¶”ê°€ ì—°êµ¬
        if needs_improvement(state):
            state = await additional_research_stage(state)
            state = await compression_stage(state)  # ì¬ì••ì¶•
    
    # STAGE 6: ìµœì¢… ë³´ê³ ì„œ
    state = await final_report_stage(state)
    
    return state
```

---

## ğŸ“Š ì›Œí¬í”Œë¡œìš° ì‹œê°í™”

### ì‹œê°„ íë¦„ë„

```
ì‹œê°„ â†’

0ë¶„    [ì‚¬ìš©ì ì§ˆë¬¸]
       â†“
1ë¶„    [STAGE 1: ëª…í™•í™”]
       â†“
2ë¶„    [STAGE 2: ì—°êµ¬ ê³„íš]
       â†“
3-8ë¶„  [STAGE 3: ë³‘ë ¬ ì—°êµ¬]
       â”œâ”€ Researcher 1 (3-5ë¶„)
       â”œâ”€ Researcher 2 (3-5ë¶„)
       â”œâ”€ Researcher 3 (3-5ë¶„)
       â””â”€ Researcher 4 (3-5ë¶„)
       â†“
9ë¶„    [STAGE 4: ì••ì¶•]
       â†“
10ë¶„   [STAGE 5: í’ˆì§ˆ ê²€ì¦] (ì„ íƒ)
       â†“
11ë¶„   [STAGE 6: ìµœì¢… ë³´ê³ ì„œ]
       â†“
12ë¶„   [ì™„ë£Œ]
```

---

## ğŸ¯ í•µì‹¬ ìš”ì•½

1. **STAGE 1**: ì§ˆë¬¸ ëª…í™•í™” (í•„ìš”ì‹œ)
2. **STAGE 2**: ì—°êµ¬ ê³„íš ìˆ˜ë¦½
3. **STAGE 3**: ë³‘ë ¬ ì—°êµ¬ ìˆ˜í–‰
4. **STAGE 4**: ì •ë³´ ì••ì¶• ë° í†µí•©
5. **STAGE 5**: í’ˆì§ˆ ê²€ì¦ (ì„ íƒ)
6. **STAGE 6**: ìµœì¢… ë³´ê³ ì„œ ìƒì„±

## ğŸ“š ë‹¤ìŒ ë‹¨ê³„

ì›Œí¬í”Œë¡œìš°ë¥¼ ì´í•´í–ˆë‹¤ë©´, **05_ì‹¤í–‰_ê°€ì´ë“œ.md**ì—ì„œ ì‹¤ì œë¡œ ì‹œìŠ¤í…œì„ ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì„¸ìš”!
